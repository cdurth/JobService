var xmldoc = require('xmldoc');

var xml =
'<sdata:payload><SO_InvoiceHeaderSPECIAL sdata:uri="http://66.161.168.57:80/Sdata/MasApp/MasContract/ABC/SO_InvoiceHeaderSPECIAL(\'0100057\')" xmlns=""><SO_InvoiceHeaderSPECIALSECOND><SO_InvoiceTierDistribution><InvoiceNo>0100057</InvoiceNo><LineKey>000001</LineKey><LotSerialNo>300-1282</LotSerialNo><TierType>4</TierType><ItemCode>GB-MD789</ItemCode><WarehouseCode>002</WarehouseCode><SalesOrderNo xsi:nil="true" /><OrderLineKey xsi:nil="true" /><QuantityOrdered>0.0000</QuantityOrdered><QuantityShipped>1.0000</QuantityShipped><TierUnitCost>0.0000</TierUnitCost><UnitOfMeasureConvFactor>1.0000</UnitOfMeasureConvFactor></SO_InvoiceTierDistribution><SO_InvoiceTierDistribution><InvoiceNo>0100057</InvoiceNo><LineKey>000001</LineKey><LotSerialNo>300-6531</LotSerialNo><TierType>4</TierType><ItemCode>GB-MD789</ItemCode><WarehouseCode>002</WarehouseCode><SalesOrderNo xsi:nil="true" /><OrderLineKey xsi:nil="true" /><QuantityOrdered>0.0000</QuantityOrdered><QuantityShipped>1.0000</QuantityShipped><TierUnitCost>0.0000</TierUnitCost><UnitOfMeasureConvFactor>1.0000</UnitOfMeasureConvFactor></SO_InvoiceTierDistribution><SO_InvoiceTierDistribution><InvoiceNo>0100057</InvoiceNo><LineKey>000001</LineKey><LotSerialNo>315-9877</LotSerialNo><TierType>4</TierType><ItemCode>GB-MD789</ItemCode><WarehouseCode>002</WarehouseCode><SalesOrderNo xsi:nil="true" /><OrderLineKey xsi:nil="true" /><QuantityOrdered>0.0000</QuantityOrdered><QuantityShipped>1.0000</QuantityShipped><TierUnitCost>0.0000</TierUnitCost><UnitOfMeasureConvFactor>1.0000</UnitOfMeasureConvFactor></SO_InvoiceTierDistribution><SO_InvoiceTierDistribution><InvoiceNo>0100057</InvoiceNo><LineKey>000001</LineKey><LotSerialNo>325-9088</LotSerialNo><TierType>4</TierType><ItemCode>GB-MD789</ItemCode><WarehouseCode>002</WarehouseCode><SalesOrderNo xsi:nil="true" /><OrderLineKey xsi:nil="true" /><QuantityOrdered>0.0000</QuantityOrdered><QuantityShipped>1.0000</QuantityShipped><TierUnitCost>0.0000</TierUnitCost><UnitOfMeasureConvFactor>1.0000</UnitOfMeasureConvFactor></SO_InvoiceTierDistribution><InvoiceNo>0100057</InvoiceNo><LineKey>000001</LineKey><LineSeqNo>00000100000000</LineSeqNo><ItemCode>GB-MD789</ItemCode><ItemType>1</ItemType><ItemCodeDesc>MODEM 300</ItemCodeDesc><ExtendedDescriptionKey xsi:nil="true" /><Discount>Y</Discount><Commissionable>Y</Commissionable><SubjectToExemption>Y</SubjectToExemption><WarehouseCode>002</WarehouseCode><ProductLine>DC</ProductLine><Valuation>6</Valuation><PriceLevel>1</PriceLevel><UnitOfMeasure>EACH</UnitOfMeasure><DropShip>N</DropShip><LotSerialFullyDistributed>Y</LotSerialFullyDistributed><SalesKitLineKey xsi:nil="true" /><CostOfGoodsSoldAcctKey>450010000</CostOfGoodsSoldAcctKey><SalesAcctKey>400010000</SalesAcctKey><PriceOverridden>N</PriceOverridden><OrderWarehouse xsi:nil="true" /><ExplodedKitItem>N</ExplodedKitItem><OrderLineKey xsi:nil="true" /><Revision>000</Revision><BillOption1 xsi:nil="true" /><BillOption2 xsi:nil="true" /><BillOption3 xsi:nil="true" /><BillOption4 xsi:nil="true" /><BillOption5 xsi:nil="true" /><BillOption6 xsi:nil="true" /><BillOption7 xsi:nil="true" /><BillOption8 xsi:nil="true" /><BillOption9 xsi:nil="true" /><BackorderKitCompLine>N</BackorderKitCompLine><StandardKitBill>N</StandardKitBill><SkipPrintCompLine>N</SkipPrintCompLine><AliasItemNo xsi:nil="true" /><TaxClass>TX</TaxClass><SOHistoryDetlSeqNo xsi:nil="true" /><CustomerAction>N</CustomerAction><WarrantyCode xsi:nil="true" /><ExpirationDate>0001-01-01T00:00:00+00:00</ExpirationDate><ExpirationOverridden>N</ExpirationOverridden><CostOverridden>N</CostOverridden><ItemAction>N</ItemAction><CostCode xsi:nil="true" /><CostType xsi:nil="true" /><CommentText xsi:nil="true" /><PromiseDate>0001-01-01T00:00:00+00:00</PromiseDate><APDivisionNo>01</APDivisionNo><VendorNo>STEV</VendorNo><PurchaseOrderNo xsi:nil="true" /><PurchaseOrderRequiredDate>0001-01-01T00:00:00+00:00</PurchaseOrderRequiredDate><QuantityOrdered>4.0000</QuantityOrdered><QuantityShipped>4.0000</QuantityShipped><QuantityBackordered>0.0000</QuantityBackordered><UnitPrice>66.0250</UnitPrice><ExtensionAmt>264.1000</ExtensionAmt><ExtendedCost>0.0000</ExtendedCost><ExtendedNegQtyAdj>0.0000</ExtendedNegQtyAdj><UnitCost>39.5400</UnitCost><UnitOfMeasureConvFactor>1.0000</UnitOfMeasureConvFactor><CommissionAmt>0.0000</CommissionAmt><QuantityPerBill>0.0000</QuantityPerBill><LineDiscountPercent>0.0000</LineDiscountPercent><LineWeight>0.0000</LineWeight></SO_InvoiceHeaderSPECIALSECOND><SO_InvoicePayment>http://66.161.168.57/Sdata/MasApp/MasContract/ABC/SO_InvoicePayment/?where=InvoiceNo eq \'0100057\'</SO_InvoicePayment><InvoiceNo>0100057</InvoiceNo><InvoiceDate>2015-01-23T00:00:00-08:00</InvoiceDate><InvoiceType>IN</InvoiceType><SalesOrderNo xsi:nil="true" /><OrderType>1</OrderType><OrderStatus xsi:nil="true" /><OrderDate>0001-01-01T00:00:00+00:00</OrderDate><ARDivisionNo>01</ARDivisionNo><CustomerNo>ABF</CustomerNo><BillToDivisionNo xsi:nil="true" /><BillToCustomerNo xsi:nil="true" /><BillToName>American Business Futures</BillToName><BillToAddress1>2131 N. 14th Street</BillToAddress1><BillToAddress2>Suite 100</BillToAddress2><BillToAddress3>Accounting Department</BillToAddress3><BillToCity>Milwaukee</BillToCity><BillToState>WI</BillToState><BillToZipCode>53205-1204</BillToZipCode><BillToCountryCode>USA</BillToCountryCode><ShipToCode>2</ShipToCode><ShipToName>American Business Futures</ShipToName><ShipToAddress1>Racine Warehouse</ShipToAddress1><ShipToAddress2>5411 Kendrick Place</ShipToAddress2><ShipToAddress3 xsi:nil="true" /><ShipToCity>Racine</ShipToCity><ShipToState>WI</ShipToState><ShipToZipCode>53120</ShipToZipCode><ShipToCountryCode>USA</ShipToCountryCode><ShipDate>2015-01-23T00:00:00-08:00</ShipDate><ShipVia>UPS BLUE</ShipVia><ShipZone xsi:nil="true" /><ShipZoneActual xsi:nil="true" /><ShipWeight>00000</ShipWeight><CustomerPONo xsi:nil="true" /><FOB xsi:nil="true" /><WarehouseCode>001</WarehouseCode><ConfirmTo>John Quinn</ConfirmTo><Comment xsi:nil="true" /><TaxSchedule>WI</TaxSchedule><TermsCode>01</TermsCode><TaxExemptNo xsi:nil="true" /><PrintInvoice>Y</PrintInvoice><InvoicePrinted>N</InvoicePrinted><AcceptCashOnly>N</AcceptCashOnly><CustomerType xsi:nil="true" /><ResidentialAddress>N</ResidentialAddress><InvalidTaxCalc>N</InvalidTaxCalc><FreightCalculationMethod>W</FreightCalculationMethod><CheckNoForDeposit xsi:nil="true" /><ApplyToInvoiceNo xsi:nil="true" /><LotSerialLinesExist>N</LotSerialLinesExist><SalespersonDivisionNo>01</SalespersonDivisionNo><SalespersonNo>0100</SalespersonNo><SplitCommissions>N</SplitCommissions><SalespersonDivisionNo2 xsi:nil="true" /><SalespersonNo2 xsi:nil="true" /><SalespersonDivisionNo3 xsi:nil="true" /><SalespersonNo3 xsi:nil="true" /><SalespersonDivisionNo4 xsi:nil="true" /><SalespersonNo4 xsi:nil="true" /><SalespersonDivisionNo5 xsi:nil="true" /><SalespersonNo5 xsi:nil="true" /><InvoiceDueDate>2015-02-22T00:00:00-08:00</InvoiceDueDate><DiscountDueDate>2015-01-23T00:00:00-08:00</DiscountDueDate><BatchNo>00001</BatchNo><EBMSubmissionType xsi:nil="true" /><EBMUserIDSubmittingThisOrder xsi:nil="true" /><EBMUserType xsi:nil="true" /><EMailUpdateFlagForRestart xsi:nil="true" /><FaxNo xsi:nil="true" /><BatchFax>N</BatchFax><BatchEmail>N</BatchEmail><EmailAddress>corey@corey.com</EmailAddress><PaymentType xsi:nil="true" /><OtherPaymentTypeRefNo xsi:nil="true" /><PaymentTypeCategory>D</PaymentTypeCategory><OrderChangedInShipping>N</OrderChangedInShipping><LinesChangedInShipping>N</LinesChangedInShipping><ShipperID xsi:nil="true" /><ShipStatus xsi:nil="true" /><StarshipFreightUsed>N</StarshipFreightUsed><StarshipRecordsCreated>N</StarshipRecordsCreated><JobNo xsi:nil="true" /><RMANo xsi:nil="true" /><CRMUserID xsi:nil="true" /><CRMCompanyID xsi:nil="true" /><CRMPersonID xsi:nil="true" /><CRMOpportunityID xsi:nil="true" /><InvalidWarrantyCode>N</InvalidWarrantyCode><TaxableSubjectToDiscount>0.0000</TaxableSubjectToDiscount><NonTaxableSubjectToDiscount>264.1000</NonTaxableSubjectToDiscount><TaxSubjToDiscPrcntOfTotSubjTo>0.0000</TaxSubjToDiscPrcntOfTotSubjTo><DiscountRate>0.0000</DiscountRate><TaxableAmt>0.0000</TaxableAmt><NonTaxableAmt>264.1000</NonTaxableAmt><SalesTaxAmt>0.0000</SalesTaxAmt><DiscountAmt>0.0000</DiscountAmt><RetentionAmt>0.0000</RetentionAmt><TotalSubjectToComm>0.0000</TotalSubjectToComm><CommissionRate>10.0000</CommissionRate><CommissionAmt>0.0000</CommissionAmt><SplitCommRate2>0.0000</SplitCommRate2><SplitCommRate3>0.0000</SplitCommRate3><SplitCommRate4>0.0000</SplitCommRate4><SplitCommRate5>0.0000</SplitCommRate5><OverrideCommAmt>0.0000</OverrideCommAmt><FreightAmt>0.0000</FreightAmt><CostOfGoodsSoldAmt>0.0000</CostOfGoodsSoldAmt><CostOfGoodsSoldSubjToComm>0.0000</CostOfGoodsSoldSubjToComm><DepositAmt>0.0000</DepositAmt><Weight>0.0000</Weight><SIShippedLinesCOGS>0.0000</SIShippedLinesCOGS><NumberOfCODLabels>0</NumberOfCODLabels><NumberOfBackOrderLines>0</NumberOfBackOrderLines><NumberOfShippingLabels>0</NumberOfShippingLabels><LastNoOfShippingLabels>0</LastNoOfShippingLabels><NumberofPackages>0</NumberofPackages><DateCreated>2015-01-23T00:00:00-08:00</DateCreated><TimeCreated>12.183</TimeCreated><UserCreatedKey>0000000003</UserCreatedKey><DateUpdated>2015-01-23T00:00:00-08:00</DateUpdated><TimeUpdated>12.183</TimeUpdated><UserUpdatedKey>0000000003</UserUpdatedKey></SO_InvoiceHeaderSPECIAL></sdata:payload>'

var doc = new xmldoc.XmlDocument(xml);

var recursion = function (xmlNode){
  var ret = [];
  xmlNode.eachChild(function(child,index,array){
    if(child.children.length < 1) {
        ret[child.name] = child.val;
    } else {
        ret[xmlNode.name] = recursion(child);
    }
  });
  return ret;
};
console.log(recursion(doc));
